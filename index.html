<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>[나의 사랑 안에 거하라]</title>
  <link rel="stylesheet" href="style/styles.css" />
  <link rel="stylesheet" href="style/modal.css">
  <!-- Open Graph 메타 태그 -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="나의 사랑 안에 거하라 : 안디옥 대학청년 연합수련회" />
  <meta property="og:description" content="2025-08/14~16 | 구미안디옥교회" />
  <meta property="og:image" content="https://abide-in-my-love.netlify.app/img/meta.png" />
  <meta property="og:url" content="https://abide-in-my-love.netlify.app/" />
  <meta name="description" content="2025 안디옥교회 대학청년 연합수련회 안내 : 조, 숙소, 일정, 식단, 응급연락망 등 전체 확인 가능." />
</head>

<body>
  <!-- 오른쪽 상단 고정 수정 버튼 -->
  <button id="editRequestBtn" class="floating-btn top-right-btn">수정 요청</button>

  <div id="loading" style="text-align:center; margin-top: 100px;">
    <img src="img/loading-spinner.gif" width="60" alt="로딩 중..."><br>
    <p>로딩 중입니다...</p>
  </div>

<div id="editModal" class="modal">
  <div class="modal-content">
    <span class="close-btn" id="closeModal">&times;</span>
    <p class="example-text">
      예시)<br>
      - 저는 OOO인데 제 이름이 이상해요.<br>
      - 제 이름이 명단에 없어요.<br>
      - 숙소 정보가 잘못되었어요.<br>
      - 기타 잘못된 내용을 알려주세요.
    </p>
    
    <!-- ✅ 이름 입력 필드 추가 -->
    <input type="text" id="editName" placeholder="이름을 입력하세요" style="width:90%; padding:10px; margin-bottom:10px;"/>

    <textarea id="editContent" rows="6" placeholder="수정할 내용을 입력하세요"></textarea>
    <br><br>
    <button id="submitEditBtn" onclick="submitEditRequest()">제출</button>
    <p id="editMsg" style="margin-top:10px;"></p>
  </div>
</div>



  <div id="app" style="display:none;">
    <header id="header">
      <div class="header-overlay">
        <p id="typing-text"></p>
      </div>
    </header>

    <div class="grid-container">
      <h3>내 정보 찾기</h3>

      <!-- <label for="nameInput" >이름</label> -->
      <input
        type="text"
        id="nameInput"
        placeholder="이름을 입력하세요"
        class="grid-item"
      />
      <!-- 주요 조회 버튼 -->
      <button id="grd1" class="grid-item" onclick="appHandlers.findTeam()">나의 조 찾기 🔍</button>
      <button id="grd2" class="grid-item" onclick="appHandlers.findRoom()">나의 숙소 찾기 🏠</button>
      <!-- <button id="grd9" class="grid-item" onclick="appHandlers.showFasting()">나의 금식기도 🙏</button> -->
      <br>
      <h3>전체 정보 찾기</h3>
      <button id="grd3" class="grid-item" onclick="appHandlers.showAllTeams()">전체 조 보기 👥</button>
      <button id="grd4" class="grid-item" onclick="appHandlers.showAllRooms()">전체 숙소표 보기 👨‍👩‍👧‍👦</button>
      <!-- <button id="grd10" class="grid-item" onclick="appHandlers.showAllFasting()">전체 금식기도자 보기 🙌</button> -->
      <br>
      <h3>기타 기능</h3>
      <button id="grd5" class="grid-item" onclick="appHandlers.showEmergency()">응급 연락망 📞</button>
      <button id="grd6" class="grid-item" onclick="appHandlers.showSchedule()">일정 📅</button>
      <button id="grd7" class="grid-item" onclick="appHandlers.showFood()">식단표 🍲</button>
      <button id="grd8" class="grid-item" onclick="appHandlers.showResolution()">결단문 ✍️</button>
      <!-- <button id="grd11" class="grid-item" onclick="appHandlers.showLinktree()">안디옥 소셜 네트워크 ✍️</button> -->
      <br>
    </div>

    <!-- 결과 출력 영역 -->
    <div class="grid-item results team-info" id="teamInfo"></div>
    <div class="grid-item results room-info" id="roomInfo" style="display: none;"></div>
    <div class="grid-item results team-list" id="allTeams"></div>
    <div class="grid-item results all-rooms" id="allRooms" style="display: none;"></div>
    <div class="grid-item results emergency-info" id="emergencyInfo"></div>
    <div class="grid-item results schedule-info" id="scheduleInfo"></div>
    <div class="grid-item results food-info" id="foodInfo" style="display: none;"></div>
    <div class="grid-item results resolution-info" id="resolutionInfo"></div>
    <div class="grid-item results fasting-info" id="fastingInfo" style="display: none;"></div>
    <div class="grid-item results all-fasting-info" id="allFastingInfo" style="display: none;"></div>
    <div class="grid-item results all-linktree-info" id="allLinktreeInfo" style="display: none;"></div>


    <!-- footer -->
    <footer>
      <p>
        &copy; 2025 서로 사랑하라<br />
        Designed with 🌿 by <br />
        <a href="https://www.youtube.com/@hewilldoit">Antioch Church</a>
      </p>
    </footer>
  </div>

  <!-- 맨 위로 이동 버튼 -->
  <button id="scrollTopBtn" class="floating-btn">⬆ 맨 위로</button>

  <!-- 스크립트 -->
  <script type="module" src="./js/main.js"></script>
  <script type="module" src="./js/init.js"></script>
  <script type="module" src="./js/ui-buttons.js"></script>
  <script type="module" src="./js/modal.js"></script>
  <script type="module" src="./js/utils/mode-change.js"></script>
</body>
</html>
<script>
  console.log("🔥 inline JS 테스트: index.html에서 직접 실행");
  
</script>
<script type="module">
  import { initModeToggle } from "./js/utils/mode-change.js";
  initModeToggle();
</script>
<script type="module">
  import { db } from './js/firebase-config.js';
  import { collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

  window.submitEditRequest = async function () {
    const name = document.getElementById("editName").value.trim(); // ✅ 이름 입력값
    const content = document.getElementById("editContent").value.trim();
    const msg = document.getElementById("editMsg");

    if (!name) {
      alert("이름을 입력해주세요.");
      return;
    }

    if (!content) {
      alert("수정 내용을 입력해주세요.");
      return;
    }

    try {
      await addDoc(collection(db, "edit_requests"), {
        name: name, // ✅ Firestore에 이름 추가 저장
        content: content,
        timestamp: serverTimestamp(),
        userAgent: navigator.userAgent
      });

      msg.innerText = "✅ 수정 요청이 제출되었습니다. 감사합니다!";
      msg.style.color = "lightgreen";
      document.getElementById("editName").value = ""; // 입력 초기화
      document.getElementById("editContent").value = "";

    } catch (error) {
      console.error("수정 요청 저장 오류:", error);
      msg.innerText = "❌ 저장 중 오류가 발생했습니다.";
      msg.style.color = "red";
    }
  };
</script>
